!function(o){Zoomify=function(i,t){var n=this;this._zooming=!1,this._zoomed=!1,this._timeout=null,this.$shadow=null,this.$image=o(i).addClass("zoomify"),this.options=o.extend({},Zoomify.DEFAULTS,this.$image.data(),t),this.$image.on("click",(function(){n.zoom()})),o(window).on("resize",(function(){n.reposition()})),o(document).on("scroll",(function(){n.reposition()})),o(window).on("keyup",(function(o){n._zoomed&&27==o.keyCode&&n.zoomOut()}))},Zoomify.DEFAULTS={duration:200,easing:"linear",scale:.9},Zoomify.prototype.transition=function(o,i){o.css({"-webkit-transition":i,"-moz-transition":i,"-ms-transition":i,"-o-transition":i,transition:i})},Zoomify.prototype.addTransition=function(o){this.transition(o,"all "+this.options.duration+"ms "+this.options.easing)},Zoomify.prototype.removeTransition=function(i,t){var n=this;clearTimeout(this._timeout),this._timeout=setTimeout((function(){n.transition(i,""),o.isFunction(t)&&t.call(n)}),this.options.duration)},Zoomify.prototype.transform=function(o){this.$image.css({"-webkit-transform":o,"-moz-transform":o,"-ms-transform":o,"-o-transform":o,transform:o})},Zoomify.prototype.transformScaleAndTranslate=function(o,i,t,n){this.addTransition(this.$image),this.transform("scale("+o+") translate("+i+"px, "+t+"px)"),this.removeTransition(this.$image,n)},Zoomify.prototype.zoom=function(){this._zooming||(this._zoomed?this.zoomOut():this.zoomIn())},Zoomify.prototype.zoomIn=function(){var i=this,t=this.$image.css("transform");this.transition(this.$image,"none"),this.transform("none");var n=this.$image.offset(),s=this.$image.outerWidth(),a=this.$image.outerHeight(),e=this.$image[0].naturalWidth||1/0,m=this.$image[0].naturalHeight||1/0,r=o(window).width(),h=o(window).height(),d=Math.min(e,r*this.options.scale)/s,f=Math.min(m,h*this.options.scale)/a,u=Math.min(d,f),c=(-n.left+(r-s)/2)/u,l=(-n.top+(h-a)/2+o(document).scrollTop())/u;this.transform(t),this._zooming=!0,o("body").addClass("noscroll"),this.$image.addClass("zoomed").trigger("zoom-in.zoomify"),setTimeout((function(){i.addShadow(),i.transformScaleAndTranslate(u,c,l,(function(){i._zooming=!1,i.$image.trigger("zoom-in-complete.zoomify")})),i._zoomed=!0}))},Zoomify.prototype.zoomOut=function(){var i=this;this._zooming=!0,this.$image.trigger("zoom-out.zoomify"),this.transformScaleAndTranslate(1,0,0,(function(){i._zooming=!1,o("body").removeClass("noscroll"),i.$image.removeClass("zoomed").trigger("zoom-out-complete.zoomify")})),this.removeShadow(),this._zoomed=!1},Zoomify.prototype.reposition=function(){this._zoomed&&(this.transition(this.$image,"none"),this.zoomIn())},Zoomify.prototype.addShadow=function(){var i=this;this._zoomed||(i.$shadow&&i.$shadow.remove(),this.$shadow=o('<div class="zoomify-shadow"></div>'),o("body").append(this.$shadow),this.addTransition(this.$shadow),this.$shadow.on("click",(function(){i.zoomOut()})),setTimeout((function(){i.$shadow.addClass("zoomed")}),10))},Zoomify.prototype.removeShadow=function(){var o=this;this.$shadow&&(this.addTransition(this.$shadow),this.$shadow.removeClass("zoomed"),this.$image.one("zoom-out-complete.zoomify",(function(){o.$shadow&&o.$shadow.remove(),o.$shadow=null})))},o.fn.zoomify=function(i){return this.each((function(){var t=o(this),n=t.data("zoomify");n||t.data("zoomify",n=new Zoomify(this,"object"==typeof i&&i)),"string"==typeof i&&["zoom","zoomIn","zoomOut","reposition"].indexOf(i)>=0&&n[i]()}))}}(jQuery);